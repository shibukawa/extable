.extable-root {
	--extable-border: 1px solid #dadce0;
	--extable-accent: #3b82f6;
	--extable-invalid: #ef4444;
	--extable-header-bg: #e5e7eb;

	.extable-cell {
		border: var(--extable-border);
		padding: 4px 8px;

		&.invalid {
			outline: 1px solid var(--extable-invalid);
		}
	}

	.pending {
		color: #b91c1c;
	}

	table[data-extable-renderer="html"],
	table[data-extable-renderer="canvas-html-overlay"] {
		border-collapse: collapse;
		width: 100%;
		background: transparent;
		table-layout: fixed;
	}

	table[data-extable-renderer="canvas-html-overlay"] {
		opacity: 0;
	}

	.extable-row-header {
		position: sticky;
		left: 0;
		background: #e5e7eb;
		text-align: center;
		padding: 4px 6px;
		border: var(--extable-border);
		font-weight: 600;
		color: #334155;
		z-index: 4;
	}

	.extable-corner {
		position: sticky;
		top: 0;
		left: 0;
		z-index: 6;
		background: #e5e7eb;
		padding: 0;
	}

	.extable-corner::after {
		content: "";
		position: absolute;
		top: 4px;
		left: 4px;
		width: 12px;
		height: 12px;
		background: linear-gradient(135deg, #9ca3af 50%, transparent 50%);
	}

  .extable-active-row-header,
  .extable-active-col-header {
    background: rgba(59, 130, 246, 0.16);
  }

	.extable-selected {
		background: rgba(59, 130, 246, 0.12);
	}

	/* Selected but non-active cells keep spreadsheet-like cursor (cell). */
	td.extable-selected {
		cursor: cell;
	}

	/* Active editable cell shows text cursor, even when selected. */
	td.extable-active-cell.extable-editable {
		cursor: text;
	}

	/* Active readonly/boolean cells should not look editable. */
	td.extable-active-cell.extable-readonly {
		cursor: default;
	}

  .extable-all-selected td,
  .extable-all-selected th {
    background: rgba(59, 130, 246, 0.08);
  }

	.extable-active-cell {
		outline: 2px solid var(--extable-accent);
		outline-offset: -2px;
		position: relative;

		&::after {
			content: "";
			position: absolute;
			width: 12px;
			height: 12px;
			right: 1px;
			bottom: 1px;
			background: var(--extable-accent);
			border: 1px solid #ffffff;
			cursor: crosshair;
			opacity: 0;
		}
	}

	&[data-extable-fill-handle="1"] {
		.extable-active-cell::after {
			opacity: 1;
		}
	}

	.extable-readonly {
		background: #f3f4f6 !important;
		color: #94a3b8 !important;
		cursor: not-allowed;
	}

	.extable-editable {
		cursor: text;
	}

	th {
		position: relative;
		background: #e5e7eb;
		border: 1px solid #d0d7de;
		padding: 6px 8px;
		font-weight: 600;
		text-align: left;

		&::after {
			content: "";
			position: absolute;
			top: 0;
			right: -3px;
			width: 6px;
			height: 100%;
			cursor: col-resize;
		}
	}

	td {
		border: 1px solid #d0d7de;
		padding: 4px 6px;
		min-width: 80px;

		&:focus-within {
			outline: 2px solid #2b7fff;
			outline-offset: -1px;
		}

		&.pending {
			color: #b91c1c;
		}
	}

	.extable-context-menu hr.extable-context-sep {
		border: 0;
		border-top: 1px solid #e5e7eb;
		margin: 6px 0;
	}

	thead th {
		position: sticky;
		top: 0;
		z-index: 5;
	}

	input {
		border: none;
		padding: 2px 4px;
		width: 100%;
		box-sizing: border-box;
		background: #fff;
		font: inherit;

		&:focus {
			outline: none;
		}
	}

	.cell-nowrap {
		white-space: nowrap;
		text-overflow: ellipsis;
		overflow: hidden;
	}

	.cell-wrap {
		white-space: pre-wrap;
		text-overflow: clip;
		overflow-wrap: anywhere;
	}

	.align-left {
		text-align: left;
	}

	.align-right {
		text-align: right;
	}
}

.extable-context-menu {
	border: none;
	padding: 6px 0;
	border-radius: 8px;
	background: rgba(255, 255, 255, 0.98);
	box-shadow: 0 18px 38px rgba(0, 0, 0, 0.25), 0 8px 12px rgba(0, 0, 0, 0.18);
	backdrop-filter: blur(6px);
	min-width: 200px;
	position: fixed;
	margin: 0;
	inset: auto;
	z-index: 1000;
	pointer-events: auto;

	&::backdrop {
		background: transparent;
	}

	button {
		display: flex;
		gap: 8px;
		align-items: center;
		width: 100%;
		padding: 8px 14px;
		background: transparent;
		border: none;
		font: inherit;
		text-align: left;
		cursor: pointer;

		&:hover,
		&:focus-visible {
			background: rgba(59, 130, 246, 0.12);
			outline: none;
		}
	}
}

.extable-toast {
	border-radius: 8px;
	padding: 10px 14px;
	background: rgba(25, 25, 28, 0.92);
	color: #f8fafc;
	box-shadow: 0 12px 30px rgba(0, 0, 0, 0.28), 0 6px 12px rgba(0, 0, 0, 0.18);
	font-size: 13px;
	max-width: 320px;
	line-height: 1.4;
}

.extable-toast[data-variant="error"] {
	background: rgba(220, 38, 38, 0.92);
}
